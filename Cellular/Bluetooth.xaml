<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="Cellular.Bluetooth">

    <ScrollView>
        <VerticalStackLayout
            Padding="30,0"
            Spacing="25">
            <Image
                Source="logo.png"
                HeightRequest="185"
                Aspect="AspectFit"
                SemanticProperties.Description="RevMetrix Bowling Ball Logo" />

            <Label
                Text="Bluetooth"
                Style="{StaticResource Headline}"
                SemanticProperties.HeadingLevel="Level1" />

            <Label
                x:Name="StatusLabel"
                Text="Ready to scan"
                FontSize="16"
                TextColor="Gray" />

            <!-- Scan Button -->
            <Button
                x:Name="ScanButton"
                Text="Scan"
                Clicked="OnScanClicked"
                HorizontalOptions="Fill" />

            <!-- Device List -->
            <Label
                Text="Available Devices:"
                FontSize="18"
                FontAttributes="Bold" />

            <CollectionView
                x:Name="DeviceListView"
                ItemsSource="{Binding Devices}"
                SelectionMode="Single">
                <CollectionView.ItemTemplate>
                    <DataTemplate>
                        <Grid Padding="10">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            
                            <Label
                                Grid.Row="0"
                                Grid.Column="0"
                                Text="{Binding Name}"
                                FontSize="16"
                                FontAttributes="Bold" />
                            
                            <Label
                                Grid.Row="1"
                                Grid.Column="0"
                                Text="{Binding Id}"
                                FontSize="12"
                                TextColor="Gray" />
                            
                            <Label
                                Grid.Row="0"
                                Grid.Column="1"
                                Text="{Binding Rssi, StringFormat='{0} dBm'}"
                                FontSize="14"
                                TextColor="Gray"
                                VerticalOptions="Center" />
                        </Grid>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>

            <!-- Connect/Disconnect Buttons -->
            <Button
                x:Name="ConnectButton"
                Text="Connect"
                Clicked="OnConnectClicked"
                IsEnabled="{Binding CanConnect}"
                HorizontalOptions="Fill" />

            <Button
                x:Name="DisconnectButton"
                Text="Disconnect"
                Clicked="OnDisconnectClicked"
                IsEnabled="{Binding CanDisconnect}"
                HorizontalOptions="Fill" />

            <!-- Device Info -->
            <Label
                x:Name="DeviceInfoLabel"
                Text=""
                FontSize="14"
                TextColor="Blue" />

            <!-- Sensor Controls -->
            <Label
                Text="Sensors:"
                FontSize="18"
                FontAttributes="Bold"
                Margin="0,20,0,0" />

            <Grid ColumnDefinitions="*,*" RowDefinitions="Auto,Auto,Auto,Auto" ColumnSpacing="10" RowSpacing="10">
                <Label
                    Grid.Row="0"
                    Grid.Column="0"
                    Grid.ColumnSpan="2"
                    Text="Accelerometer"
                    FontSize="16"
                    FontAttributes="Bold" />

                <Button
                    Grid.Row="1"
                    Grid.Column="0"
                    Text="Start"
                    Clicked="OnStartAccelerometerClicked"
                    IsEnabled="{Binding CanStartAccelerometer}" />

                <Button
                    Grid.Row="1"
                    Grid.Column="1"
                    Text="Stop"
                    Clicked="OnStopAccelerometerClicked"
                    IsEnabled="{Binding CanStartAccelerometer}" />

                <Label
                    Grid.Row="2"
                    Grid.Column="0"
                    Grid.ColumnSpan="2"
                    x:Name="AccelerometerLabel"
                    Text=""
                    FontSize="14" />

                <Label
                    Grid.Row="3"
                    Grid.Column="0"
                    Grid.ColumnSpan="2"
                    Text="Gyroscope"
                    FontSize="16"
                    FontAttributes="Bold"
                    Margin="0,10,0,0" />
            </Grid>

            <Grid ColumnDefinitions="*,*" RowDefinitions="Auto,Auto" ColumnSpacing="10" RowSpacing="10">
                <Button
                    Grid.Row="0"
                    Grid.Column="0"
                    Text="Start"
                    Clicked="OnStartGyroscopeClicked"
                    IsEnabled="{Binding CanStartGyroscope}" />

                <Button
                    Grid.Row="0"
                    Grid.Column="1"
                    Text="Stop"
                    Clicked="OnStopGyroscopeClicked"
                    IsEnabled="{Binding CanStartGyroscope}" />

                <Label
                    Grid.Row="1"
                    Grid.Column="0"
                    Grid.ColumnSpan="2"
                    x:Name="GyroscopeLabel"
                    Text=""
                    FontSize="14" />
            </Grid>

            <Grid ColumnDefinitions="*,*" RowDefinitions="Auto,Auto,Auto" ColumnSpacing="10" RowSpacing="10">
                <Label
                    Grid.Row="0"
                    Grid.Column="0"
                    Grid.ColumnSpan="2"
                    Text="Magnetometer"
                    FontSize="16"
                    FontAttributes="Bold"
                    Margin="0,10,0,0" />

                <Button
                    Grid.Row="1"
                    Grid.Column="0"
                    Text="Start"
                    Clicked="OnStartMagnetometerClicked"
                    IsEnabled="{Binding CanStartMagnetometer}" />

                <Button
                    Grid.Row="1"
                    Grid.Column="1"
                    Text="Stop"
                    Clicked="OnStopMagnetometerClicked"
                    IsEnabled="{Binding CanStartMagnetometer}" />

                <Label
                    Grid.Row="2"
                    Grid.Column="0"
                    Grid.ColumnSpan="2"
                    x:Name="MagnetometerLabel"
                    Text=""
                    FontSize="14" />
            </Grid>

            <Grid ColumnDefinitions="*,*" RowDefinitions="Auto,Auto,Auto" ColumnSpacing="10" RowSpacing="10">
                <Label
                    Grid.Row="0"
                    Grid.Column="0"
                    Grid.ColumnSpan="2"
                    Text="Light Sensor"
                    FontSize="16"
                    FontAttributes="Bold"
                    Margin="0,10,0,0" />

                <Button
                    Grid.Row="1"
                    Grid.Column="0"
                    Text="Start"
                    Clicked="OnStartLightSensorClicked"
                    IsEnabled="{Binding CanStartLightSensor}" />

                <Button
                    Grid.Row="1"
                    Grid.Column="1"
                    Text="Stop"
                    Clicked="OnStopLightSensorClicked"
                    IsEnabled="{Binding CanStartLightSensor}" />

                <Label
                    Grid.Row="2"
                    Grid.Column="0"
                    Grid.ColumnSpan="2"
                    x:Name="LightSensorLabel"
                    Text=""
                    FontSize="14" />
            </Grid>

            <!-- Probe Button -->
            <Button
                x:Name="ProbeButton"
                Text="Probe Device (Debug)"
                Clicked="OnProbeClicked"
                IsEnabled="{Binding IsConnected}"
                HorizontalOptions="Fill"
                Margin="0,20,0,0"
                BackgroundColor="Orange" />

            <!-- Graph Button -->
            <Button
                x:Name="ShowGraphButton"
                Text="Show Sensor Graph"
                Clicked="OnShowGraphClicked"
                IsEnabled="{Binding IsConnected}"
                HorizontalOptions="Fill"
                Margin="0,10,0,0" />

        </VerticalStackLayout>
    </ScrollView>

</ContentPage>
